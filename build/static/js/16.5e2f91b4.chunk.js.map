{"version":3,"sources":["public/images/cha.png","public/images/mainbackground.jpg","views/login/popupLogin.tsx","views/home.tsx"],"names":["PopupLogin","state","loginSwitch","warnMessage","mobileValue","acode","captchaShow","modalVisible","wxUrl","wxState","appid","submit","value","a","console","log","username","util","validate_mobile","mobile","captcha","validate_captcha","message","validate_password","pass","validate_yzm","sms","setState","data","type","dologin","res","status","getUser","result","store","dispatch","setUserInfo","JSON","stringify","body","close","location","reload","errno","$message","info","loginRemove","toggleVisible","val","url","window","pathname","search","hash","encodeURIComponent","wechatLink","then","callback_url","app_id","this","className","id","style","height","src","mainbackground","alt","onClick","onFinish","onFinishFailed","GETFalseMessage","formName","name","MobileValue","Acode","warnimg","htmlType","to","wechartimg","qqimg","weiboimg","chaimg","title","visible","onCancel","wrapClassName","maskStyle","background","Component","Home","popupLoginShow","login","show"],"mappings":"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","file":"static/js/16.5e2f91b4.chunk.js","sourcesContent":["export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAEKADAAQAAAABAAAAEAAAAAA0VXHyAAAA/klEQVQ4EcVSQQ6CMBCkGH7g0fRAeIXceQYJSLz4Cf6hxj+gD+CCV/0AXPgHdUfZppRy8UKTZmF2Zna7reetvTbcQJIkeRiGpzRNH3VdK8bNWJalHwTBOYqibdu2L+R8Jiil9rQPTdNcQGScIzDkwAGXcU2M4/gohLhRMrNNDHEGDrhsIPgD0UEsgI+VWVwQbwCONTEAYJsAQ1dj5YkYuZkBQNPkS/q1PRMjp2eAn3+WvkYWm9XRNu03jtD3vaQrvttXPDGwxTTtQkpZQbxkog1cYsIGVETlJRNtgBdGVXLXtB0mu67rKhxbD5GET9pXtI3KPBOOwJADB1zG148fDfDVwnBmctEAAAAASUVORK5CYII=\"","export default __webpack_public_path__ + \"static/media/mainbackground.ce40917a.jpg\";","import { Component } from 'react'\nimport * as ReactDOM from 'react-dom';\nimport './popupLogin.scss'\nimport { Form , Button,Modal} from 'antd';\nimport InputComponent from './component/inputComponent';\nimport { util } from 'utils/user'\nimport {BrowserRouter as Router, Link } from 'react-router-dom';\nimport {dologin,getUser,wechatLink} from 'service/login'\nimport $message from 'views/component/message';\nimport WxLogin from 'views/login/component/othorLogin/wxLogin'\nimport { Base64 } from 'js-base64';\n\nimport store from \"store/index\";\nimport { setUserInfo,loginRemove} from \"store/actionCreators.js\";\n\nimport weiboimg from 'public/images/weibo.png'\nimport qqimg from 'public/images/QQ.png'\nimport wechartimg from 'public/images/wechart.png'\nimport warnimg from 'public/images/warn.png'\nimport mainbackground from 'public/images/mainbackground.jpg'\nimport chaimg from 'public/images/cha.png'\n\ninterface PopupLoginState{\n    show?:(val:boolean)=>void\n    userInfo?:(val:boolean)=>void\n}\n\nexport default class PopupLogin extends Component<PopupLoginState> {\n    state={\n        loginSwitch:0,\n        warnMessage:'',\n        mobileValue:'',\n        acode:'86',\n        captchaShow:false,\n        modalVisible:false,\n        wxUrl:'',//微信登录跳转地址\n        wxState:'',//微信登录设置的state\n        appid:'',//微信企业appid\n     }\n     submit=async(value)=>{\n        console.log(value)\n        let {loginSwitch} = this.state,message\n        if(loginSwitch){    \n            let username = util.validate_mobile(value.mobile)\n            if(value.captcha){\n                let captcha =  util.validate_captcha(value.captcha)\n                message = username?username:captcha?captcha:util.validate_password(value.pass) \n            }else{\n                message = username?username:util.validate_password(value.pass) \n            }\n            \n        }else{\n            let mobile = util.validate_mobile(value.mobile)     \n            if(value.captcha){\n                let captcha =  util.validate_captcha(value.captcha)\n                message = mobile?mobile:captcha?captcha:util.validate_yzm(value.sms)   \n            }else{\n                message = mobile?mobile:util.validate_yzm(value.sms)\n            }\n        }\n        this.setState({warnMessage:message})\n        value.acode && (value.acode='+'+value.acode)\n        if(!message){\n            let data:API.UserLogin = {\n                type:loginSwitch?2:1,\n                ...value,\n            }\n            const res = await dologin(data)\n            if(res.status){\n                let result = await getUser()\n               if(result.status){\n                    store.dispatch(setUserInfo(JSON.stringify(result.body)))\n               } \n                this.close()\n                location.reload();\n            }else{\n                if(res.errno && res.body>=3 || res.message==='captcha: 不能为空'){\n                    this.setState({captchaShow:true})\n                }\n            }\n             $message.info(res.message)\n        }\n    }\n    close=()=>{\n        store.dispatch(loginRemove())\n    }\n     //微信登录modal是否显示切换\n     toggleVisible=(val)=>{\n        this.setState({modalVisible:val})\n    }\n    componentDidMount(){\n        let url = window.location.pathname+window.location.search+window.location.hash\n        // let data={url:Base64.encode(url)}\n        let data={url:encodeURIComponent(url)}\n        wechatLink(data).then(res=>{\n            this.setState({\n                wxUrl:res.body.callback_url,\n                wxState:res.body.state,\n                appid:res.body.app_id\n            })\n        }) \n    }\n    render(){\n        let {loginSwitch,warnMessage,mobileValue,acode,captchaShow,wxUrl,wxState,appid}=this.state\n        return (\n            <div className='popuplogin-item fleximg' id='popuplogin-item'>0\n                <div className='flexll popuplogin'>\n                    <div className='fleximgtop mainimg' style={{height:'100px'}}>\n                        <img src={mainbackground} alt=\"main\" />\n                    </div>\n                    <div className='loginmain'>\n                        <div className='loginswitch flexl'>\n                            <div \n                                onClick={()=>{this.setState({loginSwitch:0,warnMessage:''})}}\n                                className={loginSwitch == 0?'fleximg activeborder':'fleximg'}>\n                                    手机号登录\n                            </div>\n                            <div \n                                onClick={()=>{this.setState({loginSwitch:1,warnMessage:''})}}\n                                className={loginSwitch == 1?'fleximg activeborder':'fleximg'}>\n                                账户登录\n                            </div>\n                        </div>\n                        <Form\n                            className=\" topForm\"\n                            onFinish={this.submit}\n                            onFinishFailed={this.submit}\n                        >\n                                {!loginSwitch?(\n                                    <div >\n                                        <div className='marg'>\n                                            <InputComponent  \n                                                GETFalseMessage={(val)=>{this.setState({warnMessage:val})}} \n                                                formName='mobile' \n                                                name='mobile' \n                                                height='short'\n                                                MobileValue={(val)=>{this.setState({mobileValue:val})}} \n                                                Acode={(val)=>{this.setState({acode:val})}}\n                                            />\n                                        </div> \n                                        {captchaShow && <div className='marg'>\n                                            <InputComponent \n                                                GETFalseMessage={(val)=>{this.setState({warnMessage:val})}} \n                                                height='short'\n                                                formName='captcha' \n                                                name='captcha' \n                                            />\n                                        </div>\n                                        }        \n                                        <div className='marg'>\n                                            <InputComponent  \n                                                GETFalseMessage={(val)=>{this.setState({warnMessage:val})}} \n                                                formName='sms' \n                                                name='mobileYZM' \n                                                height='short'\n                                                mobileValue={mobileValue}\n                                                acode={acode}\n                                            />\n                                        </div>\n                                </div>\n                            ):(\n                                <div>\n                                    <div className='marg'>\n                                    <InputComponent \n                                        GETFalseMessage={(val)=>{this.setState({warnMessage:val})}} \n                                        formName='mobile' \n                                        name='mobile' \n                                        height='short'\n                                        MobileValue={(val)=>{this.setState({mobileValue:val})}} \n                                        Acode={(val)=>{this.setState({acode:val})}}\n                                    />\n                                    </div>   \n                                    {captchaShow && <div className='marg'>\n                                            <InputComponent \n                                                GETFalseMessage={(val)=>{this.setState({warnMessage:val})}} \n                                                height='short'\n                                                formName='captcha' \n                                                name='captcha' \n                                            />\n                                        </div>\n                                        }  \n                                    <div className='marg'>\n                                        <InputComponent  GETFalseMessage={(val)=>{this.setState({warnMessage:val})}} formName='pass' name='password' height='short'/>\n                                    </div>                                \n                                </div>\n                            )}\n                            {warnMessage && \n                                <div className='warn flexl'>\n                                    <div><img src={warnimg} alt=\"warn\" /></div>\n                                    <span>{warnMessage}</span>\n                                </div>\n                            }\n                            \n                            <Button className='loginbt' htmlType=\"submit\">登录</Button>\n                        </Form>\n                        {loginSwitch ?\n                            <div className='forget flexb'>\n                                <Link to='/app/register/forget'><span>忘记密码？</span></Link>\n                                \n                                <Link to='/app/register/register'><span>免费注册</span></Link>\n                            </div>:\n                            <div className='forget flexr'>\n                                <Link to='/app/register/register'><span>免费注册</span></Link>\n                            </div>\n                        }\n                        <div className='fleximg'>\n                            <div className={!loginSwitch?'fleximg wechartimg':'fleximg wechartimg wechartimguser'} onClick={()=>this.toggleVisible(true)}>\n                                <img src={wechartimg}/>\n                            </div>\n                            <div className={!loginSwitch?'fleximg wechartimg':'fleximg wechartimg wechartimguser'}>\n                                <img src={qqimg}/>\n                            </div>\n                            <div className={!loginSwitch?'fleximg wechartimg':'fleximg wechartimg wechartimguser'}>\n                                <img src={weiboimg}/>\n                            </div>\n                        </div>\n                    </div>\n                    <div className='chaimg fleximgtop' onClick={this.close}>\n                        <img src={chaimg} alt=\"×\" />\n                    </div>\n                </div>\n                <Modal\n                    title=\"Modal\"\n                    visible={this.state.modalVisible}\n                    onCancel={()=>this.toggleVisible(false)}\n                    wrapClassName='wxlogin-modal'\n                    maskStyle={{background: 'rgba(0, 0, 0,0.5)'}}\n                >   \n                    <WxLogin url={wxUrl} state={wxState} appid={appid}/>\n                </Modal>\n            </div>\n        )\n        \n    }\n    \n}\n// 挂载容器到页面\n function createMessage(dom){\n    let el = document.getElementById('popuplogin-item');\n    // 这一步是必要的的，因为在执行到这里的时候，页面还没有挂载，所以获取不到el节点\n    if (!el) {\n        el = document.createElement('div')\n        el.className = 'popuplogin-item'\n        el.id = 'popuplogin-item'\n        \n    }\n    dom.append(el)\n    ReactDOM.render( <PopupLogin />, el);\n  }","\r\nimport { Component } from 'react'\r\nimport PopupLogin from './login/popupLogin'\r\n\r\nexport default class Home extends Component {\r\n    state={\r\n        popupLoginShow:false\r\n    }\r\n    \r\n    componentDidMount(){\r\n\r\n    }\r\n    login=()=>{\r\n        this.setState({\r\n            popupLoginShow:!this.state.popupLoginShow\r\n        })\r\n    }\r\n    render(){\r\n        let {popupLoginShow}=this.state\r\n        return <div id='home'>\r\n            <div onClick={this.login}>去登录</div>\r\n            {popupLoginShow &&\r\n                <div className='block'>\r\n                    <PopupLogin show={(val)=>this.setState({popupLoginShow:val})}/>\r\n                </div>\r\n\r\n            }\r\n            \r\n        </div>\r\n    }\r\n   \r\n    \r\n}"],"sourceRoot":""}