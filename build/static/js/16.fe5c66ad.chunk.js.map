{"version":3,"sources":["public/images/cha.png","public/images/mainbackground.jpg","views/login/popupLogin.tsx","views/home.tsx"],"names":["PopupLogin","state","loginSwitch","warnMessage","mobileValue","acode","captchaShow","modalVisible","wxUrl","wxState","appid","submit","value","a","console","log","username","util","validate_mobile","mobile","captcha","validate_captcha","message","validate_password","pass","validate_yzm","sms","setState","data","type","dologin","res","status","getUser","result","store","dispatch","setUserInfo","JSON","stringify","body","close","location","reload","errno","$message","info","loginRemove","toggleVisible","val","url","window","pathname","search","hash","Base64","encode","wechatLink","then","callback_url","app_id","this","className","id","style","height","src","mainbackground","alt","onClick","onFinish","onFinishFailed","GETFalseMessage","formName","name","MobileValue","Acode","warnimg","htmlType","to","wechartimg","qqimg","weiboimg","chaimg","title","visible","onCancel","wrapClassName","maskStyle","background","Component","Home","popupLoginShow","login","show"],"mappings":"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","file":"static/js/16.fe5c66ad.chunk.js","sourcesContent":["export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAEKADAAQAAAABAAAAEAAAAAA0VXHyAAAA/klEQVQ4EcVSQQ6CMBCkGH7g0fRAeIXceQYJSLz4Cf6hxj+gD+CCV/0AXPgHdUfZppRy8UKTZmF2Zna7reetvTbcQJIkeRiGpzRNH3VdK8bNWJalHwTBOYqibdu2L+R8Jiil9rQPTdNcQGScIzDkwAGXcU2M4/gohLhRMrNNDHEGDrhsIPgD0UEsgI+VWVwQbwCONTEAYJsAQ1dj5YkYuZkBQNPkS/q1PRMjp2eAn3+WvkYWm9XRNu03jtD3vaQrvttXPDGwxTTtQkpZQbxkog1cYsIGVETlJRNtgBdGVXLXtB0mu67rKhxbD5GET9pXtI3KPBOOwJADB1zG148fDfDVwnBmctEAAAAASUVORK5CYII=\"","export default __webpack_public_path__ + \"static/media/mainbackground.ce40917a.jpg\";","import { Component } from 'react'\r\nimport * as ReactDOM from 'react-dom';\r\nimport './popupLogin.scss'\r\nimport { Form , Button,Modal} from 'antd';\r\nimport InputComponent from './component/inputComponent';\r\nimport { util } from 'utils/user'\r\nimport {BrowserRouter as Router, Link } from 'react-router-dom';\r\nimport {dologin,getUser,wechatLink} from 'service/login'\r\nimport $message from 'views/component/message';\r\nimport WxLogin from 'views/login/component/othorLogin/wxLogin'\r\nimport { Base64 } from 'js-base64';\r\n\r\nimport store from \"store/index\";\r\nimport { setUserInfo,loginRemove} from \"store/actionCreators.js\";\r\n\r\nimport weiboimg from 'public/images/weibo.png'\r\nimport qqimg from 'public/images/QQ.png'\r\nimport wechartimg from 'public/images/wechart.png'\r\nimport warnimg from 'public/images/warn.png'\r\nimport mainbackground from 'public/images/mainbackground.jpg'\r\nimport chaimg from 'public/images/cha.png'\r\n\r\ninterface PopupLoginState{\r\n    show?:(val:boolean)=>void\r\n    userInfo?:(val:boolean)=>void\r\n}\r\n\r\nexport default class PopupLogin extends Component<PopupLoginState> {\r\n    state={\r\n        loginSwitch:0,\r\n        warnMessage:'',\r\n        mobileValue:'',\r\n        acode:'86',\r\n        captchaShow:false,\r\n        modalVisible:false,\r\n        wxUrl:'',//微信登录跳转地址\r\n        wxState:'',//微信登录设置的state\r\n        appid:'',//微信企业appid\r\n     }\r\n     submit=async(value)=>{\r\n        console.log(value)\r\n        let {loginSwitch} = this.state,message\r\n        if(loginSwitch){    \r\n            let username = util.validate_mobile(value.mobile)\r\n            if(value.captcha){\r\n                let captcha =  util.validate_captcha(value.captcha)\r\n                message = username?username:captcha?captcha:util.validate_password(value.pass) \r\n            }else{\r\n                message = username?username:util.validate_password(value.pass) \r\n            }\r\n            \r\n        }else{\r\n            let mobile = util.validate_mobile(value.mobile)     \r\n            if(value.captcha){\r\n                let captcha =  util.validate_captcha(value.captcha)\r\n                message = mobile?mobile:captcha?captcha:util.validate_yzm(value.sms)   \r\n            }else{\r\n                message = mobile?mobile:util.validate_yzm(value.sms)\r\n            }\r\n        }\r\n        this.setState({warnMessage:message})\r\n        value.acode && (value.acode='+'+value.acode)\r\n        if(!message){\r\n            let data:API.UserLogin = {\r\n                type:loginSwitch?2:1,\r\n                ...value,\r\n            }\r\n            const res = await dologin(data)\r\n            if(res.status){\r\n                let result = await getUser()\r\n               if(result.status){\r\n                    store.dispatch(setUserInfo(JSON.stringify(result.body)))\r\n               } \r\n                this.close()\r\n                location.reload();\r\n            }else{\r\n                if(res.errno && res.body>=3 || res.message==='captcha: 不能为空'){\r\n                    this.setState({captchaShow:true})\r\n                }\r\n            }\r\n             $message.info(res.message)\r\n        }\r\n    }\r\n    close=()=>{\r\n        store.dispatch(loginRemove())\r\n    }\r\n     //微信登录modal是否显示切换\r\n     toggleVisible=(val)=>{\r\n        this.setState({modalVisible:val})\r\n    }\r\n    componentDidMount(){\r\n        let url = window.location.pathname+window.location.search+window.location.hash\r\n        let data={url:Base64.encode(url)}\r\n        wechatLink(data).then(res=>{\r\n            this.setState({\r\n                wxUrl:res.body.callback_url,\r\n                wxState:res.body.state,\r\n                appid:res.body.app_id\r\n            })\r\n        }) \r\n    }\r\n    render(){\r\n        let {loginSwitch,warnMessage,mobileValue,acode,captchaShow,wxUrl,wxState,appid}=this.state\r\n        return (\r\n            <div className='popuplogin-item fleximg' id='popuplogin-item'>0\r\n                <div className='flexll popuplogin'>\r\n                    <div className='fleximgtop mainimg' style={{height:'100px'}}>\r\n                        <img src={mainbackground} alt=\"main\" />\r\n                    </div>\r\n                    <div className='loginmain'>\r\n                        <div className='loginswitch flexl'>\r\n                            <div \r\n                                onClick={()=>{this.setState({loginSwitch:0,warnMessage:''})}}\r\n                                className={loginSwitch == 0?'fleximg activeborder':'fleximg'}>\r\n                                    手机号登录\r\n                            </div>\r\n                            <div \r\n                                onClick={()=>{this.setState({loginSwitch:1,warnMessage:''})}}\r\n                                className={loginSwitch == 1?'fleximg activeborder':'fleximg'}>\r\n                                账户登录\r\n                            </div>\r\n                        </div>\r\n                        <Form\r\n                            className=\" topForm\"\r\n                            onFinish={this.submit}\r\n                            onFinishFailed={this.submit}\r\n                        >\r\n                                {!loginSwitch?(\r\n                                    <div >\r\n                                        <div className='marg'>\r\n                                            <InputComponent  \r\n                                                GETFalseMessage={(val)=>{this.setState({warnMessage:val})}} \r\n                                                formName='mobile' \r\n                                                name='mobile' \r\n                                                height='short'\r\n                                                MobileValue={(val)=>{this.setState({mobileValue:val})}} \r\n                                                Acode={(val)=>{this.setState({acode:val})}}\r\n                                            />\r\n                                        </div> \r\n                                        {captchaShow && <div className='marg'>\r\n                                            <InputComponent \r\n                                                GETFalseMessage={(val)=>{this.setState({warnMessage:val})}} \r\n                                                height='short'\r\n                                                formName='captcha' \r\n                                                name='captcha' \r\n                                            />\r\n                                        </div>\r\n                                        }        \r\n                                        <div className='marg'>\r\n                                            <InputComponent  \r\n                                                GETFalseMessage={(val)=>{this.setState({warnMessage:val})}} \r\n                                                formName='sms' \r\n                                                name='mobileYZM' \r\n                                                height='short'\r\n                                                mobileValue={mobileValue}\r\n                                                acode={acode}\r\n                                            />\r\n                                        </div>\r\n                                </div>\r\n                            ):(\r\n                                <div>\r\n                                    <div className='marg'>\r\n                                    <InputComponent \r\n                                        GETFalseMessage={(val)=>{this.setState({warnMessage:val})}} \r\n                                        formName='mobile' \r\n                                        name='mobile' \r\n                                        height='short'\r\n                                        MobileValue={(val)=>{this.setState({mobileValue:val})}} \r\n                                        Acode={(val)=>{this.setState({acode:val})}}\r\n                                    />\r\n                                    </div>   \r\n                                    {captchaShow && <div className='marg'>\r\n                                            <InputComponent \r\n                                                GETFalseMessage={(val)=>{this.setState({warnMessage:val})}} \r\n                                                height='short'\r\n                                                formName='captcha' \r\n                                                name='captcha' \r\n                                            />\r\n                                        </div>\r\n                                        }  \r\n                                    <div className='marg'>\r\n                                        <InputComponent  GETFalseMessage={(val)=>{this.setState({warnMessage:val})}} formName='pass' name='password' height='short'/>\r\n                                    </div>                                \r\n                                </div>\r\n                            )}\r\n                            {warnMessage && \r\n                                <div className='warn flexl'>\r\n                                    <div><img src={warnimg} alt=\"warn\" /></div>\r\n                                    <span>{warnMessage}</span>\r\n                                </div>\r\n                            }\r\n                            \r\n                            <Button className='loginbt' htmlType=\"submit\">登录</Button>\r\n                        </Form>\r\n                        {loginSwitch ?\r\n                            <div className='forget flexb'>\r\n                                <Link to='/app/register/forget'><span>忘记密码？</span></Link>\r\n                                \r\n                                <Link to='/app/register/register'><span>免费注册</span></Link>\r\n                            </div>:\r\n                            <div className='forget flexr'>\r\n                                <Link to='/app/register/register'><span>免费注册</span></Link>\r\n                            </div>\r\n                        }\r\n                        <div className='fleximg'>\r\n                            <div className={!loginSwitch?'fleximg wechartimg':'fleximg wechartimg wechartimguser'} onClick={()=>this.toggleVisible(true)}>\r\n                                <img src={wechartimg}/>\r\n                            </div>\r\n                            <div className={!loginSwitch?'fleximg wechartimg':'fleximg wechartimg wechartimguser'}>\r\n                                <img src={qqimg}/>\r\n                            </div>\r\n                            <div className={!loginSwitch?'fleximg wechartimg':'fleximg wechartimg wechartimguser'}>\r\n                                <img src={weiboimg}/>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className='chaimg fleximgtop' onClick={this.close}>\r\n                        <img src={chaimg} alt=\"×\" />\r\n                    </div>\r\n                </div>\r\n                <Modal\r\n                    title=\"Modal\"\r\n                    visible={this.state.modalVisible}\r\n                    onCancel={()=>this.toggleVisible(false)}\r\n                    wrapClassName='wxlogin-modal'\r\n                    maskStyle={{background: 'rgba(0, 0, 0,0.5)'}}\r\n                >   \r\n                    <WxLogin url={wxUrl} state={wxState} appid={appid}/>\r\n                </Modal>\r\n            </div>\r\n        )\r\n        \r\n    }\r\n    \r\n}\r\n// 挂载容器到页面\r\n function createMessage(dom){\r\n    let el = document.getElementById('popuplogin-item');\r\n    // 这一步是必要的的，因为在执行到这里的时候，页面还没有挂载，所以获取不到el节点\r\n    if (!el) {\r\n        el = document.createElement('div')\r\n        el.className = 'popuplogin-item'\r\n        el.id = 'popuplogin-item'\r\n        \r\n    }\r\n    dom.append(el)\r\n    ReactDOM.render( <PopupLogin />, el);\r\n  }","\r\nimport { Component } from 'react'\r\nimport PopupLogin from './login/popupLogin'\r\n\r\nexport default class Home extends Component {\r\n    state={\r\n        popupLoginShow:false\r\n    }\r\n    \r\n    componentDidMount(){\r\n\r\n    }\r\n    login=()=>{\r\n        this.setState({\r\n            popupLoginShow:!this.state.popupLoginShow\r\n        })\r\n    }\r\n    render(){\r\n        let {popupLoginShow}=this.state\r\n        return <div id='home'>\r\n            <div onClick={this.login}>去登录</div>\r\n            {popupLoginShow &&\r\n                <div className='block'>\r\n                    <PopupLogin show={(val)=>this.setState({popupLoginShow:val})}/>\r\n                </div>\r\n\r\n            }\r\n            \r\n        </div>\r\n    }\r\n   \r\n    \r\n}"],"sourceRoot":""}